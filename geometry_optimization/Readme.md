# Geometry optimization

In order to perform geometry 

we first need to obtain an optimized geometry. Sometimes when we make a new structure, like heterostructures, we may also need to obtain an optimum cell as well. The cell optimization has only one more variable than geometry optimization which is pressure and will let the cell change its size when the optimizer is working after each cell optimization step. In CP2K it is better to perform both cell and geometry optimization together which is done by the keyword TYPE DIRECT_CELL_OPT in the  &CELL_OPT section of the input. 
For other structures, like supercells, you usually obtain from cif files, the structure may be optimized when you perform the geometry optimization but usually this is not the case. Therefore, you need to perform geometry optimization first. If the changes in the structure is massive then you need to move to cell optimization as well. You can first use a n initial cutoff value for this purpose and then after obtaining the optimized geometry performing the convergence analysis to obtain a good cutoff and if the initial cutoff is not the same as the one obtained form convergence analysis then you can redo the geometry optimization by the new cutoff value. This will not take longer than the previous geometry optimization and will give you a good result. 
Note that the CP2K optimizer works based on the forces on each. In fact, the movement of the atoms is based on their computed forces. The lower the convergence criteria the more accurate the forces. This will lead to a better optimized geometry and will not confuse the optimizer. So, it is recommended to use a relatively high cutoff value and a small target accuracy of SCF cycle defined by EPS_SCF, like 10-8. After you obtained the optimized geometry, for the MD you can use lower EPS_SCF values like 10-6. But the more accurate the force in MD the more accurate the time-overlaps are and therefore the more accurate the nonadiabatic couplings will be. 
